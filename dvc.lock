schema: '2.0'
stages:
  profile:
    cmd: python3 src/profiling.py assets/data/raw/
    deps:
    - path: assets/data/raw
      md5: 5db4d07a4e555df2fbca654c339aafcb.dir
      size: 13916988041
      nfiles: 31
    - path: src/profile.yaml
      md5: cc6d00e2d406bfc3dd079e37e6615497
      size: 3915
    - path: src/profiling.py
      md5: c415ea825e74495b5532a7730b702c1a
      size: 1716
    params:
      params.yaml:
        profile.dataset: wesad_csv
    outs:
    - path: assets/profile
      md5: 6f29f6f375e9f78a515b7735713de414.dir
      size: 102141458
      nfiles: 2
  clean:
    cmd: python3 src/clean.py assets/data/raw/
    deps:
    - path: assets/data/raw
      md5: 5db4d07a4e555df2fbca654c339aafcb.dir
      size: 13916988041
      nfiles: 31
    - path: assets/profile
      md5: 6f29f6f375e9f78a515b7735713de414.dir
      size: 102141458
      nfiles: 2
    - path: src/clean.py
      md5: 7db1b079aab25aeea93581778b2290e1
      size: 6510
    params:
      params.yaml:
        clean.classification: true
        clean.combine_files: true
        clean.correlation_metric: pearson
        clean.input_max_correlation_threshold: 1.0
        clean.onehot_encode_target: true
        clean.percentage_zeros_threshold: 0.5
        clean.target: label
    outs:
    - path: assets/data/cleaned
      md5: cc22565e72cd6b572393f2b65186aedf.dir
      size: 107181636
      nfiles: 1
    - path: assets/data/output_columns.csv
      md5: dae7d14321f45f5cab0026165afde0f7
      size: 43
  featurize:
    cmd: python3 src/featurize.py assets/data/cleaned/
    deps:
    - path: assets/data/cleaned
      md5: cc22565e72cd6b572393f2b65186aedf.dir
      size: 107181636
      nfiles: 1
    - path: assets/data/output_columns.csv
      md5: dae7d14321f45f5cab0026165afde0f7
      size: 43
    - path: src/featurize.py
      md5: 16a1dbfb74673f3868359e06cbed5d78
      size: 9060
    params:
      params.yaml:
        clean.target: label
        featurize.add_rolling_features: false
        featurize.features:
        featurize.remove_features:
        featurize.rolling_window_size: 512
        featurize.target_min_correlation_threshold: 0.0
    outs:
    - path: assets/data/featurized
      md5: 08b43242c11be3179cc4e8bcf19a77e7.dir
      size: 107181636
      nfiles: 1
    - path: assets/data/input_columns.csv
      md5: d9ad0d926d7a2f05be180598ebbe9e79
      size: 57
  split:
    cmd: python3 src/split.py assets/data/featurized/
    deps:
    - path: assets/data/featurized
      md5: 08b43242c11be3179cc4e8bcf19a77e7.dir
      size: 107181636
      nfiles: 1
    - path: src/split.py
      md5: e8f2e0571a7b77f599919a1cdcf445ed
      size: 4339
    params:
      params.yaml:
        split.calibrate_split: 0.0
        split.shuffle_files: false
        split.shuffle_samples: true
        split.train_split: 0.7
    outs:
    - path: assets/data/split
      md5: 5d06f3d942982cd865e2858ee3bd383c.dir
      size: 107181715
      nfiles: 2
  scale:
    cmd: python3 src/scale.py assets/data/split/
    deps:
    - path: assets/data/output_columns.csv
      md5: dae7d14321f45f5cab0026165afde0f7
      size: 43
    - path: assets/data/split
      md5: 5d06f3d942982cd865e2858ee3bd383c.dir
      size: 107181715
      nfiles: 2
    - path: src/scale.py
      md5: 2a663a78882c10e2926f19a1d5b476d8
      size: 3919
    params:
      params.yaml:
        clean.classification: true
        scale.input: standard
        scale.output: minmax
    outs:
    - path: assets/data/scaled
      md5: 088c66e8a06e617c70035c91b385e09b.dir
      size: 184148820
      nfiles: 2
  sequentialize:
    cmd: python3 src/sequentialize.py assets/data/scaled/
    deps:
    - path: assets/data/output_columns.csv
      md5: dae7d14321f45f5cab0026165afde0f7
      size: 43
    - path: assets/data/scaled
      md5: 088c66e8a06e617c70035c91b385e09b.dir
      size: 184148820
      nfiles: 2
    - path: src/preprocess_utils.py
      md5: 33ed484f984b29b58fa998227ac8669c
      size: 8697
    - path: src/sequentialize.py
      md5: 14c14a24cadc4769e713ebbc865577ed
      size: 2148
    params:
      params.yaml:
        clean.classification: true
        sequentialize.hist_size: 2560
        sequentialize.target_size: 1
        train.net: cnn
    outs:
    - path: assets/data/sequentialized
      md5: 90b7fbc9df2d949694724191facc3ba2.dir
      size: 92033076
      nfiles: 2
  combine:
    cmd: python3 src/combine.py assets/data/sequentialized/
    deps:
    - path: assets/data/sequentialized
      md5: 90b7fbc9df2d949694724191facc3ba2.dir
      size: 92033076
      nfiles: 2
    - path: src/combine.py
      md5: 44f218ee816f2330daa6a8f985ab5515
      size: 1813
    outs:
    - path: assets/data/combined
      md5: d46a9add40197e27bf00654e8900858b.dir
      size: 92033076
      nfiles: 2
  train:
    cmd: python3 src/train.py assets/data/combined/train.npz
    deps:
    - path: assets/data/combined
      md5: d46a9add40197e27bf00654e8900858b.dir
      size: 92033076
      nfiles: 2
    - path: assets/data/output_columns.csv
      md5: dae7d14321f45f5cab0026165afde0f7
      size: 43
    - path: src/model.py
      md5: a8da29bb3b2b78d4b78d86a1a460d714
      size: 10694
    - path: src/train.py
      md5: 750aeff0348d27f406aa5923b86b2846
      size: 6642
    params:
      params.yaml:
        clean.classification: true
        train.batch_size: 128
        train.early_stopping: true
        train.kernel_size: 9
        train.n_epochs: 100
        train.net: cnn
        train.patience: 30
    outs:
    - path: assets/models
      md5: 1119b6bb72a411e2a5fccf0d7f75ad3b.dir
      size: 51338960
      nfiles: 1
  evaluate:
    cmd: python3 src/evaluate.py assets/models/model.h5 assets/data/combined/train.npz
      assets/data/combined/test.npz assets/data/combined/calibrate.npz
    deps:
    - path: assets/data/combined/test.npz
      md5: 29ead7fecc1f6002b1c6065ff3161e97
      size: 27618314
    - path: assets/data/output_columns.csv
      md5: dae7d14321f45f5cab0026165afde0f7
      size: 43
    - path: assets/models/model.h5
      md5: 3a4f1bc72aa0b78d0fdd990a66366ca3
      size: 51338960
    - path: src/evaluate.py
      md5: 878b49cc0bc35ed184bed927e57307a8
      size: 14060
    params:
      params.yaml:
        clean.classification: true
    outs:
    - path: assets/metrics/metrics.json
      md5: 4892fb647c9dd0bddd435f39867dc90f
      size: 33
