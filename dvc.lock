schema: '2.0'
stages:
  profile:
    cmd: python3 src/profiling.py assets/data/preprocessed
    deps:
    - path: assets/data/preprocessed
      md5: f24bba93b556094f59ccbee4f9f1d626.dir
      size: 95198572
      nfiles: 15
    - path: src/profile.yaml
      md5: cc6d00e2d406bfc3dd079e37e6615497
      size: 3915
    - path: src/profiling.py
      md5: bf1749dc952c8bd257b8a70c1283551e
      size: 1368
    outs:
    - path: assets/profile
      md5: 67883a3fa3f93d6376c166c99b0751e5.dir
      size: 78089352
      nfiles: 2
  clean:
    cmd: python3 src/clean.py assets/data/preprocessed
    deps:
    - path: assets/data/raw
      md5: df69e644ab7035580f184f7143c1072b.dir
      size: 13827625074
      nfiles: 16
    - path: assets/profile
      md5: 67883a3fa3f93d6376c166c99b0751e5.dir
      size: 78089352
      nfiles: 2
    - path: src/clean.py
      md5: d493c1f7f9b3445a90f4dc3dd26c6c7d
      size: 6356
    params:
      params.yaml:
        clean.classification: true
        clean.combine_files: true
        clean.correlation_metric: pearson
        clean.input_max_correlation_threshold: 1.0
        clean.onehot_encode_target: true
        clean.percentage_zeros_threshold: 1.0
        clean.target: label
    outs:
    - path: assets/data/cleaned
      md5: 1d1a0ecb3317806b25513bde86857e9a.dir
      size: 106361734
      nfiles: 1
    - path: assets/data/output_columns.csv
      md5: 9494bbae181385b0009aabcd72afa849
      size: 33
  featurize:
    cmd: python3 src/featurize.py assets/data/cleaned/
    deps:
    - path: assets/data/cleaned
      md5: 1d1a0ecb3317806b25513bde86857e9a.dir
      size: 106361734
      nfiles: 1
    - path: assets/data/output_columns.csv
      md5: 9494bbae181385b0009aabcd72afa849
      size: 33
    - path: src/featurize.py
      md5: 16a1dbfb74673f3868359e06cbed5d78
      size: 9060
    params:
      params.yaml:
        clean.target: label
        featurize.add_rolling_features: false
        featurize.features:
        featurize.remove_features:
        featurize.rolling_window_size: 512
        featurize.target_min_correlation_threshold: 0.0
    outs:
    - path: assets/data/featurized
      md5: c7b8783409a8d70611c9ce4b9070ede9.dir
      size: 106361734
      nfiles: 1
    - path: assets/data/input_columns.csv
      md5: 10276d6b0a7ccb086dee057d48b9c1c8
      size: 82
  split:
    cmd: python3 src/split.py assets/data/featurized/
    deps:
    - path: assets/data/featurized
      md5: e1742e3a01ad0b4febd01ad0429f8de7.dir
      size: 106361734
      nfiles: 1
    - path: src/split.py
      md5: e8f2e0571a7b77f599919a1cdcf445ed
      size: 4339
    params:
      params.yaml:
        split.calibrate_split: 0.0
        split.shuffle_files: false
        split.shuffle_samples: true
        split.train_split: 0.7
    outs:
    - path: assets/data/split
      md5: 6fee5f66bf9b7824b32b0b7a7cf15eee.dir
      size: 106361826
      nfiles: 2
  scale:
    cmd: python3 src/scale.py assets/data/split/
    deps:
    - path: assets/data/output_columns.csv
      md5: 9494bbae181385b0009aabcd72afa849
      size: 33
    - path: assets/data/split
      md5: 6fee5f66bf9b7824b32b0b7a7cf15eee.dir
      size: 106361826
      nfiles: 2
    - path: src/scale.py
      md5: 2a663a78882c10e2926f19a1d5b476d8
      size: 3919
    params:
      params.yaml:
        clean.classification: true
        scale.input: standard
        scale.output: minmax
    outs:
    - path: assets/data/scaled
      md5: 947541ae154a7f7ccd3a746db1ed79d9.dir
      size: 152765396
      nfiles: 2
  sequentialize:
    cmd: python3 src/sequentialize.py assets/data/scaled/
    deps:
    - path: assets/data/output_columns.csv
      md5: 9494bbae181385b0009aabcd72afa849
      size: 33
    - path: assets/data/scaled
      md5: 947541ae154a7f7ccd3a746db1ed79d9.dir
      size: 152765396
      nfiles: 2
    - path: src/preprocess_utils.py
      md5: 33ed484f984b29b58fa998227ac8669c
      size: 8697
    - path: src/sequentialize.py
      md5: 14c14a24cadc4769e713ebbc865577ed
      size: 2148
    params:
      params.yaml:
        clean.classification: true
        sequentialize.hist_size: 1
        sequentialize.target_size: 1
        train.net: lstm
    outs:
    - path: assets/data/sequentialized
      md5: 92c63fec03da7dc6084cb41e8d2107b0.dir
      size: 152765396
      nfiles: 2
  combine:
    cmd: python3 src/combine.py assets/data/sequentialized/
    deps:
    - path: assets/data/sequentialized
      md5: 92c63fec03da7dc6084cb41e8d2107b0.dir
      size: 152765396
      nfiles: 2
    - path: src/combine.py
      md5: 44f218ee816f2330daa6a8f985ab5515
      size: 1813
    outs:
    - path: assets/data/combined
      md5: 95e8665811a4327fcb08ef4b743ad445.dir
      size: 152765396
      nfiles: 2
  train:
    cmd: python3 src/train.py assets/data/combined/train.npz
    deps:
    - path: assets/data/combined
      md5: 95e8665811a4327fcb08ef4b743ad445.dir
      size: 152765396
      nfiles: 2
    - path: assets/data/output_columns.csv
      md5: 9494bbae181385b0009aabcd72afa849
      size: 33
    - path: src/model.py
      md5: 1efc25de89333851175f7a2454522702
      size: 10852
    - path: src/train.py
      md5: 96e0798e41184f41a8dbff2d070c279a
      size: 6644
    params:
      params.yaml:
        clean.classification: true
        train.batch_size: 128
        train.early_stopping: false
        train.kernel_size: 9
        train.n_epochs: 10
        train.net: lstm
        train.patience: 5
    outs:
    - path: assets/models
      md5: 1a91a37f559f556a4cfe4029d6e84c7e.dir
      size: 53872
      nfiles: 1
  evaluate:
    cmd: python3 src/evaluate.py assets/models/model.h5 assets/data/combined/train.npz
      assets/data/combined/test.npz assets/data/combined/calibrate.npz
    deps:
    - path: assets/data/combined/test.npz
      md5: 9f49c95bbe399a13fa453be35ff3eca6
      size: 45829858
    - path: assets/data/output_columns.csv
      md5: 9494bbae181385b0009aabcd72afa849
      size: 33
    - path: assets/models/model.h5
      md5: 1ae702e10c34447acf115a4978cfe0c7
      size: 53872
    - path: src/evaluate.py
      md5: d1f1efd5cbd12cdf1ce06464b53f27ee
      size: 14068
    params:
      params.yaml:
        clean.classification: true
    outs:
    - path: assets/metrics/metrics.json
      md5: 4d1733b6f7908fac03f815f24463226b
      size: 31
  restructure:
    cmd: python3 src/preprocess.py assets/data/raw/WESAD/
  preprocess:
    cmd: python3 src/preprocess.py assets/data/raw
    deps:
    - path: assets/data/raw
      md5: df69e644ab7035580f184f7143c1072b.dir
      size: 13827625074
      nfiles: 16
    - path: src/preprocess.py
      md5: db9bf6cfcf249f326102cd27bcdc5cd1
      size: 4387
    params:
      params.yaml:
        preprocess.dataset: WESAD
        preprocess.labels:
        - 1
        - 2
        - 3
    outs:
    - path: assets/data/preprocessed
      md5: f24bba93b556094f59ccbee4f9f1d626.dir
      size: 95198572
      nfiles: 15
