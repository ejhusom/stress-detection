schema: '2.0'
stages:
  profile:
    cmd: python3 src/profiling.py assets/data/raw
    deps:
    - path: assets/data/raw
      md5: be46de455d64596af50528a16abe9a49.dir
      size: 13922823646
      nfiles: 31
    - path: src/config.py
      md5: 581c58923dda757a36e5cdd604ee0c40
      size: 1983
    - path: src/profile.yaml
      md5: 317b4d9674ca46acc17a1e8da4fa604e
      size: 3918
    - path: src/profiling.py
      md5: a0de3f466aff6d4d8e2e19269f5a9f15
      size: 1689
    params:
      params.yaml:
        profile.dataset:
    outs:
    - path: assets/profile
      md5: 33001e9cc10a9c4f828d92d46c057f82.dir
      size: 78023126
      nfiles: 2
  clean:
    cmd: python3 src/clean.py assets/data/raw
    deps:
    - path: assets/data/raw
      md5: be46de455d64596af50528a16abe9a49.dir
      size: 13922823646
      nfiles: 31
    - path: assets/profile
      md5: 33001e9cc10a9c4f828d92d46c057f82.dir
      size: 78023126
      nfiles: 2
    - path: src/clean.py
      md5: 0ad632bc85c55b5f6e80176bcbd97d25
      size: 6959
    - path: src/config.py
      md5: 581c58923dda757a36e5cdd604ee0c40
      size: 1983
    params:
      params.yaml:
        clean.classification: true
        clean.combine_files: false
        clean.correlation_metric: pearson
        clean.input_max_correlation_threshold: 1.0
        clean.onehot_encode_target: false
        clean.percentage_zeros_threshold: 1.0
        clean.target: label
    outs:
    - path: assets/data/cleaned
      md5: fc9eb056e0d712c311889bf2d77b59c5.dir
      size: 95198572
      nfiles: 15
    - path: assets/data/output_columns.csv
      md5: 6ce1c68917ca3988d2c92aeffaf7e4ad
      size: 11
  featurize:
    cmd: python3 src/featurize.py assets/data/cleaned/
    deps:
    - path: assets/data/cleaned
      md5: fc9eb056e0d712c311889bf2d77b59c5.dir
      size: 95198572
      nfiles: 15
    - path: assets/data/output_columns.csv
      md5: 6ce1c68917ca3988d2c92aeffaf7e4ad
      size: 11
    - path: src/config.py
      md5: 581c58923dda757a36e5cdd604ee0c40
      size: 1983
    - path: src/featurize.py
      md5: 8874449f9c4b66aa0393df50b02d3cf4
      size: 12924
    params:
      params.yaml:
        clean.target: label
        featurize.add_rolling_features: true
        featurize.features:
        - wrist_acc_x
        - wrist_acc_y
        - wrist_acc_z
        - wrist_temp
        - wrist_eda
        - wrist_bvp
        featurize.remove_features:
        - wrist_acc_x
        - wrist_acc_y
        - wrist_acc_z
        - wrist_temp
        - wrist_eda
        - wrist_bvp
        featurize.rolling_window_size: 512
        featurize.target_min_correlation_threshold: 0.0
    outs:
    - path: assets/data/featurized
      md5: 52c1f84128faaef4b45543d962cdfee7.dir
      size: 625764568
      nfiles: 15
    - path: assets/data/input_columns.csv
      md5: bf58113d3f75b4a35c407d6a6b1c1628
      size: 881
  split:
    cmd: python3 src/split.py assets/data/featurized/
    deps:
    - path: assets/data/featurized
      md5: 52c1f84128faaef4b45543d962cdfee7.dir
      size: 625764568
      nfiles: 15
    - path: src/config.py
      md5: 581c58923dda757a36e5cdd604ee0c40
      size: 1983
    - path: src/split.py
      md5: eab3104cf0603f6f72b71fffb62d7e61
      size: 3720
    params:
      params.yaml:
        split.calibrate_split: 0.0
        split.shuffle_files: false
        split.train_split: 0.7
    outs:
    - path: assets/data/split
      md5: 810977acaa1b8afc4a74ee0a4832cf61.dir
      size: 625764568
      nfiles: 15
  scale:
    cmd: python3 src/scale.py assets/data/split/
    deps:
    - path: assets/data/output_columns.csv
      md5: 6ce1c68917ca3988d2c92aeffaf7e4ad
      size: 11
    - path: assets/data/split
      md5: 810977acaa1b8afc4a74ee0a4832cf61.dir
      size: 625764568
      nfiles: 15
    - path: src/config.py
      md5: 581c58923dda757a36e5cdd604ee0c40
      size: 1983
    - path: src/scale.py
      md5: e271c31f8dd63f7ecef59b792ec00592
      size: 3995
    params:
      params.yaml:
        clean.classification: true
        scale.input: standard
        scale.output: minmax
    outs:
    - path: assets/data/scaled
      md5: 668cb04e02ffe77c048e5c43cbe4da04.dir
      size: 625769998
      nfiles: 15
  sequentialize:
    cmd: python3 src/sequentialize.py assets/data/scaled/
    deps:
    - path: assets/data/output_columns.csv
      md5: 6ce1c68917ca3988d2c92aeffaf7e4ad
      size: 11
    - path: assets/data/scaled
      md5: 668cb04e02ffe77c048e5c43cbe4da04.dir
      size: 625769998
      nfiles: 15
    - path: src/config.py
      md5: 581c58923dda757a36e5cdd604ee0c40
      size: 1983
    - path: src/preprocess_utils.py
      md5: 1345869b29113d665af3d4bd22ba5b56
      size: 8660
    - path: src/sequentialize.py
      md5: dd923dad122f577ecfa3f166e7b10910
      size: 2250
    params:
      params.yaml:
        clean.classification: true
        sequentialize.shuffle_samples: false
        sequentialize.target_size: 1
        sequentialize.window_size: 1
        train.learning_method: xgboost
    outs:
    - path: assets/data/sequentialized
      md5: 65075d130e19923b9ba71c0094433647.dir
      size: 625769998
      nfiles: 15
  combine:
    cmd: python3 src/combine.py assets/data/sequentialized/
    deps:
    - path: assets/data/sequentialized
      md5: 65075d130e19923b9ba71c0094433647.dir
      size: 625769998
      nfiles: 15
    - path: src/combine.py
      md5: d175bad0793f77c653fed58d9941c567
      size: 1806
    - path: src/config.py
      md5: 581c58923dda757a36e5cdd604ee0c40
      size: 1983
    outs:
    - path: assets/data/combined
      md5: 44b5ce3938e13e11de19a66be4c5d1b7.dir
      size: 625763628
      nfiles: 2
  train:
    cmd: python3 src/train.py assets/data/combined/train.npz
    deps:
    - path: assets/data/combined
      md5: 44b5ce3938e13e11de19a66be4c5d1b7.dir
      size: 625763628
      nfiles: 2
    - path: assets/data/output_columns.csv
      md5: 6ce1c68917ca3988d2c92aeffaf7e4ad
      size: 11
    - path: src/config.py
      md5: 581c58923dda757a36e5cdd604ee0c40
      size: 1983
    - path: src/neural_networks.py
      md5: 1f42b9ab17c79817755c6870ad65cf8d
      size: 12366
    - path: src/train.py
      md5: 7daf88bb8cbef564186273ed7eab4e62
      size: 8205
    params:
      params.yaml:
        clean.classification: true
        train.batch_size: 128
        train.early_stopping: true
        train.kernel_size: 9
        train.learning_method: xgboost
        train.n_epochs: 500
        train.patience: 10
    outs:
    - path: assets/models
      md5: 44af4a6d6e0f66f40e68e7f8ae4c485d.dir
      size: 16472
      nfiles: 1
  evaluate:
    cmd: python3 src/evaluate.py assets/models/model.h5 assets/data/combined/train.npz
      assets/data/combined/test.npz assets/data/combined/calibrate.npz
    deps:
    - path: assets/data/combined/test.npz
      md5: 8fedee78a2080f43ab6c3db7c48329b9
      size: 208063922
    - path: assets/data/output_columns.csv
      md5: 6ce1c68917ca3988d2c92aeffaf7e4ad
      size: 11
    - path: assets/models/model.h5
      md5: 0fc2db6be3724cd0403baa90d8bfcf9a
      size: 16472
    - path: src/evaluate.py
      md5: 8e215361eecfefa6a35f61d58a315fc5
      size: 13229
    params:
      params.yaml:
        clean.classification: true
    outs:
    - path: assets/metrics/metrics.json
      md5: f30277d7dbee4003d95694514b25e9f2
      size: 32
